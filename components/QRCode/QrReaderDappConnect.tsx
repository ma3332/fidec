import { useState, Fragment } from "react";
import ReactQrReader from "react-qr-reader-es6";
import IconSVG from "../Icons/IconSVG";
// import './styles.scss'
/**
 * Types
 */
interface IProps {
  onConnect: (uri: string) => Promise<void>;
}

/**
 * Component
 */
export default function QrReaderDappConnect({ onConnect }: IProps) {
  const [show, setShow] = useState(false);
  const [loading, setLoading] = useState(false);

  function onError() {
    setShow(false);
  }

  async function onScan(data: string | null) {
    if (data) {
      await onConnect(data);
      setShow(false);
    }
  }

  function onShowScanner() {
    setLoading(true);
    setShow(true);
  }

  return (
    <div className="camera--dapp--container">
      {show ? (
        <Fragment>
          {loading && <div className="loading" />}
          <div className="qrVideoMask">
            <div className="qrContainer">
              <ReactQrReader
                onLoad={() => setLoading(false)}
                showViewFinder={false}
                onError={onError}
                onScan={onScan}
                style={{ width: "160px", height: "160px", margin: "auto" }}
                className="qr--content"
              />
            </div>
          </div>
        </Fragment>
      ) : (
        <div className="container--qrPlaceholder">
          <div className="qr-image">
            <IconSVG iconName="scan-qr" />
            <div className="qr">
              <svg
                width="140"
                height="140"
                viewBox="0 0 140 140"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clipPath="url(#clip0_363_738)">
                  <path
                    d="M52.5 0H0V52.5H52.5V0ZM43.75 43.75H8.75V8.75H43.75V43.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M17.5 17.5H35V35H17.5V17.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M0 140H52.5V87.5H0V140ZM8.75 96.25H43.75V131.25H8.75V96.25Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M17.5 105H35V122.5H17.5V105Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M87.5 0V52.5H140V0H87.5ZM131.25 43.75H96.25V8.75H131.25V43.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M105 17.5H122.5V35H105V17.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M17.5 61.25H0V78.75H26.25V70H17.5V61.25Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M61.25 78.75H78.75V96.25H61.25V78.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M26.25 61.25H43.75V70H26.25V61.25Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M78.75 105H61.25V113.75H70V122.5H78.75V113.75V105Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M52.5 61.25V70H43.75V78.75H61.25V61.25H52.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M70 35H78.75V52.5H70V35Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M78.75 70V78.75H96.25V61.25H70V70H78.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M61.25 52.5H70V61.25H61.25V52.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M78.75 122.5H96.25V140H78.75V122.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M61.25 122.5H70V140H61.25V122.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M78.75 96.25H87.5V105H78.75V96.25Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M78.75 26.25V8.75H70V0H61.25V35H70V26.25H78.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M105 122.5H113.75V140H105V122.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M105 105H122.5V113.75H105V105Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M96.25 113.75H105V122.5H96.25V113.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M87.5 105H96.25V113.75H87.5V105Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M122.5 87.5V96.25H131.25V105H140V87.5H131.25H122.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M131.25 113.75H122.5V140H140V122.5H131.25V113.75Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M87.5 87.5V96.25H113.75V78.75H96.25V87.5H87.5Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <path
                    d="M105 61.25V70H122.5V78.75H140V61.25H122.5H105Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                  <rect
                    x="6"
                    y="57"
                    width="128"
                    height="32"
                    rx="5"
                    fill="#ECBF40"
                    onClick={onShowScanner}
                  />
                  <path
                    d="M25.5591 78.112C24.8125 78.112 24.0985 78 23.4171 77.776C22.7358 77.5427 22.1991 77.244 21.8071 76.88L22.3251 75.788C22.6985 76.1147 23.1745 76.3853 23.7531 76.6C24.3318 76.8147 24.9338 76.922 25.5591 76.922C26.1285 76.922 26.5905 76.8567 26.9451 76.726C27.2998 76.5953 27.5611 76.418 27.7291 76.194C27.8971 75.9607 27.9811 75.6993 27.9811 75.41C27.9811 75.074 27.8691 74.8033 27.6451 74.598C27.4305 74.3927 27.1458 74.2293 26.7911 74.108C26.4458 73.9773 26.0631 73.8653 25.6431 73.772C25.2231 73.6787 24.7985 73.5713 24.3691 73.45C23.9491 73.3193 23.5618 73.156 23.2071 72.96C22.8618 72.764 22.5818 72.5027 22.3671 72.176C22.1525 71.84 22.0451 71.4107 22.0451 70.888C22.0451 70.384 22.1758 69.922 22.4371 69.502C22.7078 69.0727 23.1185 68.732 23.6691 68.48C24.2291 68.2187 24.9385 68.088 25.7971 68.088C26.3665 68.088 26.9311 68.1627 27.4911 68.312C28.0511 68.4613 28.5365 68.676 28.9471 68.956L28.4851 70.076C28.0651 69.796 27.6218 69.5953 27.1551 69.474C26.6885 69.3433 26.2358 69.278 25.7971 69.278C25.2465 69.278 24.7938 69.348 24.4391 69.488C24.0845 69.628 23.8231 69.8147 23.6551 70.048C23.4965 70.2813 23.4171 70.5427 23.4171 70.832C23.4171 71.1773 23.5245 71.4527 23.7391 71.658C23.9631 71.8633 24.2478 72.0267 24.5931 72.148C24.9478 72.2693 25.3351 72.3813 25.7551 72.484C26.1751 72.5773 26.5951 72.6847 27.0151 72.806C27.4445 72.9273 27.8318 73.086 28.1771 73.282C28.5318 73.478 28.8165 73.7393 29.0311 74.066C29.2458 74.3927 29.3531 74.8127 29.3531 75.326C29.3531 75.8207 29.2178 76.2827 28.9471 76.712C28.6765 77.132 28.2565 77.4727 27.6871 77.734C27.1271 77.986 26.4178 78.112 25.5591 78.112ZM34.2264 78.084C33.4704 78.084 32.7938 77.9207 32.1964 77.594C31.6084 77.2673 31.1464 76.8193 30.8104 76.25C30.4744 75.6807 30.3064 75.0273 30.3064 74.29C30.3064 73.5527 30.4744 72.8993 30.8104 72.33C31.1464 71.7607 31.6084 71.3173 32.1964 71C32.7938 70.6733 33.4704 70.51 34.2264 70.51C34.8984 70.51 35.4958 70.6453 36.0184 70.916C36.5504 71.1773 36.9611 71.5693 37.2504 72.092L36.2284 72.75C35.9858 72.386 35.6871 72.12 35.3324 71.952C34.9871 71.7747 34.6138 71.686 34.2124 71.686C33.7271 71.686 33.2931 71.7933 32.9104 72.008C32.5278 72.2227 32.2244 72.526 32.0004 72.918C31.7764 73.3007 31.6644 73.758 31.6644 74.29C31.6644 74.822 31.7764 75.284 32.0004 75.676C32.2244 76.068 32.5278 76.3713 32.9104 76.586C33.2931 76.8007 33.7271 76.908 34.2124 76.908C34.6138 76.908 34.9871 76.824 35.3324 76.656C35.6871 76.4787 35.9858 76.208 36.2284 75.844L37.2504 76.488C36.9611 77.0013 36.5504 77.398 36.0184 77.678C35.4958 77.9487 34.8984 78.084 34.2264 78.084ZM43.3865 78V76.432L43.3165 76.138V73.464C43.3165 72.8947 43.1485 72.456 42.8125 72.148C42.4858 71.8307 41.9911 71.672 41.3285 71.672C40.8898 71.672 40.4605 71.7467 40.0405 71.896C39.6205 72.036 39.2658 72.2273 38.9765 72.47L38.4165 71.462C38.7991 71.154 39.2565 70.9207 39.7885 70.762C40.3298 70.594 40.8945 70.51 41.4825 70.51C42.4998 70.51 43.2838 70.7573 43.8345 71.252C44.3852 71.7467 44.6605 72.5027 44.6605 73.52V78H43.3865ZM40.9505 78.084C40.3998 78.084 39.9145 77.9907 39.4945 77.804C39.0838 77.6173 38.7665 77.3607 38.5425 77.034C38.3185 76.698 38.2065 76.32 38.2065 75.9C38.2065 75.4987 38.2998 75.1347 38.4865 74.808C38.6825 74.4813 38.9951 74.22 39.4245 74.024C39.8631 73.828 40.4511 73.73 41.1885 73.73H43.5405V74.696H41.2445C40.5725 74.696 40.1198 74.808 39.8865 75.032C39.6531 75.256 39.5365 75.5267 39.5365 75.844C39.5365 76.208 39.6811 76.502 39.9705 76.726C40.2598 76.9407 40.6612 77.048 41.1745 77.048C41.6785 77.048 42.1171 76.936 42.4905 76.712C42.8731 76.488 43.1485 76.1613 43.3165 75.732L43.5825 76.656C43.4052 77.0947 43.0925 77.4447 42.6445 77.706C42.1965 77.958 41.6318 78.084 40.9505 78.084ZM50.8997 70.51C51.5063 70.51 52.0383 70.6267 52.4957 70.86C52.9623 71.0933 53.3263 71.448 53.5877 71.924C53.849 72.4 53.9797 73.002 53.9797 73.73V78H52.6357V73.884C52.6357 73.1653 52.4583 72.624 52.1037 72.26C51.7583 71.896 51.2683 71.714 50.6337 71.714C50.1577 71.714 49.7423 71.8073 49.3877 71.994C49.033 72.1807 48.7577 72.456 48.5617 72.82C48.375 73.184 48.2817 73.6367 48.2817 74.178V78H46.9377V70.58H48.2257V72.582L48.0157 72.05C48.2583 71.5647 48.6317 71.1867 49.1357 70.916C49.6397 70.6453 50.2277 70.51 50.8997 70.51ZM64.4267 78.112C63.6801 78.112 62.9847 77.986 62.3407 77.734C61.7061 77.482 61.1554 77.132 60.6887 76.684C60.2221 76.2267 59.8581 75.6947 59.5967 75.088C59.3354 74.4813 59.2047 73.8187 59.2047 73.1C59.2047 72.3813 59.3354 71.7187 59.5967 71.112C59.8581 70.5053 60.2221 69.978 60.6887 69.53C61.1554 69.0727 61.7061 68.718 62.3407 68.466C62.9754 68.214 63.6707 68.088 64.4267 68.088C65.1734 68.088 65.8594 68.214 66.4847 68.466C67.1194 68.7087 67.6701 69.0587 68.1367 69.516C68.6127 69.964 68.9767 70.4913 69.2287 71.098C69.4901 71.7047 69.6207 72.372 69.6207 73.1C69.6207 73.828 69.4901 74.4953 69.2287 75.102C68.9767 75.7087 68.6127 76.2407 68.1367 76.698C67.6701 77.146 67.1194 77.496 66.4847 77.748C65.8594 77.9907 65.1734 78.112 64.4267 78.112ZM67.6327 80.044C67.3061 80.044 66.9934 80.002 66.6947 79.918C66.3961 79.8433 66.0974 79.7173 65.7987 79.54C65.5001 79.372 65.1921 79.148 64.8747 78.868C64.5574 78.5973 64.2121 78.2613 63.8387 77.86L65.3367 77.468C65.6167 77.8133 65.8827 78.0933 66.1347 78.308C66.3961 78.532 66.6527 78.6907 66.9047 78.784C67.1567 78.8867 67.4041 78.938 67.6467 78.938C68.3467 78.938 68.9441 78.658 69.4387 78.098L70.0967 78.896C69.4621 79.6613 68.6407 80.044 67.6327 80.044ZM64.4267 76.866C64.9681 76.866 65.4674 76.7727 65.9247 76.586C66.3914 76.3993 66.7927 76.1333 67.1287 75.788C67.4741 75.4427 67.7401 75.0413 67.9267 74.584C68.1227 74.1267 68.2207 73.632 68.2207 73.1C68.2207 72.5587 68.1227 72.0593 67.9267 71.602C67.7401 71.1447 67.4741 70.748 67.1287 70.412C66.7927 70.0667 66.3914 69.8007 65.9247 69.614C65.4674 69.4273 64.9681 69.334 64.4267 69.334C63.8761 69.334 63.3674 69.4273 62.9007 69.614C62.4434 69.8007 62.0421 70.0667 61.6967 70.412C61.3514 70.748 61.0807 71.1447 60.8847 71.602C60.6981 72.0593 60.6047 72.5587 60.6047 73.1C60.6047 73.632 60.6981 74.1267 60.8847 74.584C61.0807 75.0413 61.3514 75.4427 61.6967 75.788C62.0421 76.1333 62.4434 76.3993 62.9007 76.586C63.3674 76.7727 63.8761 76.866 64.4267 76.866ZM71.5505 78V68.2H75.3725C76.2312 68.2 76.9639 68.3353 77.5705 68.606C78.1772 68.8767 78.6439 69.2687 78.9705 69.782C79.2972 70.2953 79.4605 70.9067 79.4605 71.616C79.4605 72.3253 79.2972 72.9367 78.9705 73.45C78.6439 73.954 78.1772 74.3413 77.5705 74.612C76.9639 74.8827 76.2312 75.018 75.3725 75.018H72.3205L72.9505 74.374V78H71.5505ZM78.1025 78L75.6105 74.444H77.1085L79.6285 78H78.1025ZM72.9505 74.514L72.3205 73.828H75.3305C76.2265 73.828 76.9032 73.6367 77.3605 73.254C77.8272 72.862 78.0605 72.316 78.0605 71.616C78.0605 70.916 77.8272 70.3747 77.3605 69.992C76.9032 69.6093 76.2265 69.418 75.3305 69.418H72.3205L72.9505 68.718V74.514ZM89.4442 78.112C88.6975 78.112 88.0069 77.9907 87.3722 77.748C86.7469 77.496 86.2009 77.146 85.7342 76.698C85.2769 76.2407 84.9175 75.7087 84.6562 75.102C84.3949 74.4953 84.2642 73.828 84.2642 73.1C84.2642 72.372 84.3949 71.7047 84.6562 71.098C84.9175 70.4913 85.2815 69.964 85.7482 69.516C86.2149 69.0587 86.7609 68.7087 87.3862 68.466C88.0209 68.214 88.7115 68.088 89.4582 68.088C90.2142 68.088 90.9095 68.2187 91.5442 68.48C92.1882 68.732 92.7342 69.11 93.1822 69.614L92.2722 70.496C91.8989 70.104 91.4789 69.8147 91.0122 69.628C90.5455 69.432 90.0462 69.334 89.5142 69.334C88.9635 69.334 88.4502 69.4273 87.9742 69.614C87.5075 69.8007 87.1015 70.062 86.7562 70.398C86.4109 70.734 86.1402 71.1353 85.9442 71.602C85.7575 72.0593 85.6642 72.5587 85.6642 73.1C85.6642 73.6413 85.7575 74.1453 85.9442 74.612C86.1402 75.0693 86.4109 75.466 86.7562 75.802C87.1015 76.138 87.5075 76.3993 87.9742 76.586C88.4502 76.7727 88.9635 76.866 89.5142 76.866C90.0462 76.866 90.5455 76.7727 91.0122 76.586C91.4789 76.39 91.8989 76.0913 92.2722 75.69L93.1822 76.572C92.7342 77.076 92.1882 77.4587 91.5442 77.72C90.9095 77.9813 90.2095 78.112 89.4442 78.112ZM97.6369 78.084C96.8903 78.084 96.2276 77.9207 95.6489 77.594C95.0703 77.2673 94.6129 76.8193 94.2769 76.25C93.9409 75.6713 93.7729 75.018 93.7729 74.29C93.7729 73.5527 93.9409 72.8993 94.2769 72.33C94.6129 71.7607 95.0703 71.3173 95.6489 71C96.2276 70.6733 96.8903 70.51 97.6369 70.51C98.3743 70.51 99.0323 70.6733 99.6109 71C100.199 71.3173 100.656 71.7607 100.983 72.33C101.319 72.89 101.487 73.5433 101.487 74.29C101.487 75.0273 101.319 75.6807 100.983 76.25C100.656 76.8193 100.199 77.2673 99.6109 77.594C99.0323 77.9207 98.3743 78.084 97.6369 78.084ZM97.6369 76.908C98.1129 76.908 98.5376 76.8007 98.9109 76.586C99.2936 76.3713 99.5923 76.068 99.8069 75.676C100.022 75.2747 100.129 74.8127 100.129 74.29C100.129 73.758 100.022 73.3007 99.8069 72.918C99.5923 72.526 99.2936 72.2227 98.9109 72.008C98.5376 71.7933 98.1129 71.686 97.6369 71.686C97.1609 71.686 96.7363 71.7933 96.3629 72.008C95.9896 72.2227 95.6909 72.526 95.4669 72.918C95.2429 73.3007 95.1309 73.758 95.1309 74.29C95.1309 74.8127 95.2429 75.2747 95.4669 75.676C95.6909 76.068 95.9896 76.3713 96.3629 76.586C96.7363 76.8007 97.1609 76.908 97.6369 76.908ZM106.202 78.084C105.483 78.084 104.839 77.9253 104.27 77.608C103.71 77.2907 103.266 76.8473 102.94 76.278C102.613 75.7087 102.45 75.046 102.45 74.29C102.45 73.534 102.613 72.876 102.94 72.316C103.266 71.7467 103.71 71.3033 104.27 70.986C104.839 70.6687 105.483 70.51 106.202 70.51C106.827 70.51 107.392 70.65 107.896 70.93C108.4 71.21 108.801 71.63 109.1 72.19C109.408 72.75 109.562 73.45 109.562 74.29C109.562 75.13 109.412 75.83 109.114 76.39C108.824 76.95 108.428 77.3747 107.924 77.664C107.42 77.944 106.846 78.084 106.202 78.084ZM106.314 76.908C106.78 76.908 107.2 76.8007 107.574 76.586C107.956 76.3713 108.255 76.068 108.47 75.676C108.694 75.2747 108.806 74.8127 108.806 74.29C108.806 73.758 108.694 73.3007 108.47 72.918C108.255 72.526 107.956 72.2227 107.574 72.008C107.2 71.7933 106.78 71.686 106.314 71.686C105.838 71.686 105.413 71.7933 105.04 72.008C104.666 72.2227 104.368 72.526 104.144 72.918C103.92 73.3007 103.808 73.758 103.808 74.29C103.808 74.8127 103.92 75.2747 104.144 75.676C104.368 76.068 104.666 76.3713 105.04 76.586C105.413 76.8007 105.838 76.908 106.314 76.908ZM108.848 78V75.998L108.932 74.276L108.792 72.554V67.612H110.136V78H108.848ZM115.773 78.084C114.979 78.084 114.279 77.9207 113.673 77.594C113.075 77.2673 112.609 76.8193 112.273 76.25C111.946 75.6807 111.783 75.0273 111.783 74.29C111.783 73.5527 111.941 72.8993 112.259 72.33C112.585 71.7607 113.029 71.3173 113.589 71C114.158 70.6733 114.797 70.51 115.507 70.51C116.225 70.51 116.86 70.6687 117.411 70.986C117.961 71.3033 118.391 71.7513 118.699 72.33C119.016 72.8993 119.175 73.5667 119.175 74.332C119.175 74.388 119.17 74.4533 119.161 74.528C119.161 74.6027 119.156 74.6727 119.147 74.738H112.833V73.772H118.447L117.901 74.108C117.91 73.632 117.812 73.2073 117.607 72.834C117.401 72.4607 117.117 72.1713 116.753 71.966C116.398 71.7513 115.983 71.644 115.507 71.644C115.04 71.644 114.625 71.7513 114.261 71.966C113.897 72.1713 113.612 72.4653 113.407 72.848C113.201 73.2213 113.099 73.6507 113.099 74.136V74.36C113.099 74.8547 113.211 75.298 113.435 75.69C113.668 76.0727 113.99 76.3713 114.401 76.586C114.811 76.8007 115.283 76.908 115.815 76.908C116.253 76.908 116.65 76.8333 117.005 76.684C117.369 76.5347 117.686 76.3107 117.957 76.012L118.699 76.88C118.363 77.272 117.943 77.5707 117.439 77.776C116.944 77.9813 116.389 78.084 115.773 78.084Z"
                    fill="white"
                    fillOpacity="0.9"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_363_738">
                    <rect width="140" height="140" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
